#!/usr/bin/env python2.7

import os, sys
from numpy import *

start = int(sys.argv[1])
stop = int(sys.argv[2])

### grem parameters
lambdas=[1341.0,1348.5,1357.0,1364.0,1372.5,1380.0,1388.5,1396.0,1404.5,1413.0,1420.5,1428.5,1436.0,1445.0,1453.0,1461.0,1469.0,1477.0,1484.0,1492.0,1501.0,1509.0,1517.0,1524.0,1532.5,1540.5,1548.5,1557.0,1565.0,1573.0,1580.0,1591.0,1601.0,1611.0,1621.0,1631.0,1641.0,1651.0,1661.0,1671.0,1681.0,1691.0,1700.0,1710.0,1721.0,1731.0,1741.0,1750.5,1761.0,1771.0,1781.0,1791.0,1801.0,1811.0,1821.0,1831.0,1841.0,1850.5,1861.0,1871.0,1880.5,1891.0,1900.5,1911.0,1921.0,1931.0,1940.0,1951.0,1961.0,1970.5,1981.0,1990.0,2001.0,2011.0,2021.0,2030.5,2041.0,2051.0,2061.0,2071.0,2081.0,2091.0,2101.0,2111.0,2121.0,2131.0,2140.5,2150.5,2161.0,2171.0,2181.0,2191.0,2201.0,2210.5,2221.0,2231.0,2240.5,2250.5,2261.0,2271.0,2280.5,2290.0,2301.0,2311.0,2321.0,2331.0,2341.0,2351.0,2361.0,2371.0,2381.0,2391.0,2400.0,2411.0,2421.0,2430.5,2441.0,2450.0,2461.0,2470.0,2480.0,2491.0,2501.0,2511.0]
ll = len(lambdas)
eta = -.05
H0 = -100000
Elo = -80000
Ehi = -50000

### bin size
bsize = 30.0

### min  max and how many bins:
dmin, dmax = Elo, Ehi
bb = int((dmax-dmin)/bsize)

output = open("TofH.dat", "w")

for l in range(ll):
	print lambdas[l]
	data = loadtxt("./replica-%d_%d-%d.dat" % (l,start,stop))
	ile = int(len(data))/2

	hist, edges = histogramdd(ravel(data), bins=bb, range=[(dmin, dmax)])

	### location of max
	m = edges[0][hist.argmax()]+bsize/2
	teff = lambdas[l] + (eta*(m-H0))

	output.write("%f %f %d\n" % (m, teff, l))

output.close()

